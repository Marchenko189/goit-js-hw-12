{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const fetchPhotosByQuery = (searchedQuery, currentPage) => {\n    const searchParams = new URLSearchParams({\n        q: searchedQuery,\n        page: currentPage,\n        per_page: 15,\n        key: '48268337-f168b7768f25a86360e21e8ce',\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n    });\n\n    return axios.get(`https://pixabay.com/api/?${searchParams}`);\n};\n","export const createGalleryCardTemplate = imgInfo => {\n\n  return `\n    <li class=\"js-gallery-card\">\n    <div class=\"container-gallery\">\n     <a class=\"gallery-link\" href=\"${imgInfo.largeImageURL}\">\n      <img\n      class=\"js-gallery-img\"\n      src=\"${imgInfo.webformatURL}\" \n      alt=\"${imgInfo.tags}\" \n      />\n      </a>\n      <div class=\"js-gallery-info\">\n  <p class=\"js-gallery-stats\">\n    Likes <span class=\"js-gallery-span\">${imgInfo.likes}</span>\n    </p>\n  <p class=\"js-gallery-stats\">\n    Views <span class=\"js-gallery-span\">${imgInfo.views}</span>\n    </p>\n  <p class=\"js-gallery-stats\">\n    Comments <span class=\"js-gallery-span\">${imgInfo.comments}</span>\n    </p>\n  <p class=\"js-gallery-stats\">\n    Downloads <span class=\"js-gallery-span\">${imgInfo.downloads}</span>\n  </p>\n    </div>\n    </div>\n    </li>\n  `;\n};\n\nexport const createLoadingIndicator = () => {\n  const loadingIndicatorHTML = document.createElement('div');\n  loadingIndicatorHTML.textContent = 'Loading images, please wait...';\n  loadingIndicatorHTML.classList.add('loading-container');\n\n  const span = document.createElement('span');\n  span.classList.add('loader');\n\n  loadingIndicatorHTML.appendChild(span);\n  \n  document.body.appendChild(loadingIndicatorHTML);\n\n  return loadingIndicatorHTML;\n};\n\nexport const toggleLoadingIndicator = (loadingIndicator, show) => {\n    if (show) {\n        loadingIndicator.classList.add('show');\n    } else {\n        loadingIndicator.classList.remove('show');\n    }\n};\n","import { fetchPhotosByQuery } from './js/pixabay-api';\n\nimport { createGalleryCardTemplate } from './js/render-functions';\n\nimport { createLoadingIndicator } from './js/render-functions'; \n\nimport { toggleLoadingIndicator } from './js/render-functions';\n\nimport iziToast from \"izitoast\";\n\nimport SimpleLightbox from \"simplelightbox\";\n\n\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loadMoreBtnEl = document.querySelector('.js-load-more-btn');\nlet loadingIndicator = document.querySelector('.loading-container');\n\n\nlet page = 1;\nlet searchedQuery = '';\n\nconst onSearchFormSubmit = async event => {\n    try {\n    event.preventDefault();\n\n    searchedQuery = event.currentTarget.elements.user_query.value.trim();\n\n      if (searchedQuery === '') {\n        iziToast.warning({\n            title: \"Caution\",\n            titleColor: '#fff',\n            message: 'The field must be filled!',\n            messageColor: '#fff',\n            position: 'topRight',\n            color: '#ffa000',\n        });\n\n        return;\n        }\n        \n        page = 1;\n\n        loadMoreBtnEl.classList.add('is-hidden');\n\n    if (!loadingIndicator) {\n        loadingIndicator = createLoadingIndicator();\n    }\n\n    toggleLoadingIndicator(loadingIndicator, true);\n    \n    \n    const { data } = await fetchPhotosByQuery(searchedQuery, page);\n\n    toggleLoadingIndicator(loadingIndicator, false);\n\n    if (data.hits.length === 0) {\n        iziToast.error({\n            title: \"Error\",\n            titleColor: '#fff',\n            message: 'Sorry, there are no images matching your search query. Please try again!',\n            messageColor: '#fff',\n            position: 'topRight',\n            color: '#ef4040',\n        });\n\n        galleryEl.innerHTML = '';\n\n        searchFormEl.reset();\n\n        return;\n\n        }\n\n    if (data.totalHits > page * 15) {\n      loadMoreBtnEl.classList.remove('is-hidden');\n\n      loadMoreBtnEl.addEventListener('click', onLoadMoreBtnClick);\n    }\n\n    const galleryTemplate = data.hits.map(el => createGalleryCardTemplate(el)).join('');\n\n    galleryEl.innerHTML = galleryTemplate;\n            \n    const lightbox = new SimpleLightbox('.js-gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250\n    });\n            \n    lightbox.refresh();\n    \n    searchFormEl.reset(); \n    } catch (err) {\n        console.log(err);\n    }\n};\n\n \nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\n\nconst onLoadMoreBtnClick = async event => {\n    try {\n    loadMoreBtnEl.classList.add('is-hidden');\n    page++;\n\n    if (!loadingIndicator) {\n        loadingIndicator = createLoadingIndicator();\n    }\n\n    toggleLoadingIndicator(loadingIndicator, true);\n    \n    const { data } = await fetchPhotosByQuery(searchedQuery, page);\n      \n    toggleLoadingIndicator(loadingIndicator, false);\n\n    const galleryTemplate = data.hits.map(el => createGalleryCardTemplate(el)).join('');\n\n    galleryEl.insertAdjacentHTML('beforeend', galleryTemplate);\n    \n    let galleryCard = document.querySelector('.js-gallery-card');\n        let rect = galleryCard.getBoundingClientRect();\n        console.log(rect);\n        window.scrollBy({\n            top: 2 * rect.height,\n            behavior: \"smooth\",\n        });\n    \n\n    if (page * 15 >= data.totalHits) {\n      loadMoreBtnEl.classList.add('is-hidden');\n\n      loadMoreBtnEl.removeEventListener('click', onLoadMoreBtnClick);\n       \n      iziToast.info({\n        titleColor: '#fff',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        messageColor: '#fff',\n        position: 'topRight',\n        color: '#59a10d',\n        }); \n    }\n        \n    else {\n      loadMoreBtnEl.classList.remove('is-hidden');\n        }\n        \n  } catch (err) {\n    console.log(err);\n  }\n};\n"],"names":["fetchPhotosByQuery","searchedQuery","currentPage","searchParams","axios","createGalleryCardTemplate","imgInfo","createLoadingIndicator","loadingIndicatorHTML","span","toggleLoadingIndicator","loadingIndicator","show","searchFormEl","galleryEl","loadMoreBtnEl","page","onSearchFormSubmit","event","iziToast","data","onLoadMoreBtnClick","galleryTemplate","el","SimpleLightbox","err","rect"],"mappings":"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"}